<?php

use PROJ\Helper\XssHelper;
use PROJ\Helper\RightHelper;

$toTranslate = array("management", "home", "rpl", "my_account", "change_password", "users", "upload_excelsheet", "locations", "reviews", "projects", "coordinator");
$translator = new PROJ\Services\TranslationService();
$translated = $translator->translateAll($toTranslate);

$em = \PROJ\Helper\DoctrineHelper::instance()->getEntityManager();
$user = $em->getRepository('\PROJ\Entities\Account')->find($_SESSION['userID'])->getStudent();

$header = new \PROJ\Tools\Template("Partial/Header");
$header->title = "User Management";

echo $header;

$bar = new \PROJ\Tools\Template("Partial/TopBar");
echo $bar;

$content = new \PROJ\Tools\Template("Management/" . $page);
$content->additionalValues = $additionalValues;
?>
<div id="blackout">
    <?php
    $blackoutContent = new \PROJ\Tools\Template("Management/Partial/BlackoutContent");
    echo $blackoutContent;
    ?>
</div>
<div id="management_left">
    <h2><?php echo $translated["management"] ?></h2>

    <div class="menuitem" style="border-top:1px solid #d2dce1; margin-top:20px;">
        <a href="/Management/Home"><?php echo $translated["home"] ?></a>
    </div>
    <div class="menuitem">
        <a href="/Management/MyReviews"><?php echo $translated["rpl"] ?></a>
    </div>
    <div class="menuitem">
        <a href="/Management/MyAccount"><?php echo $translated["my_account"] ?></a>
    </div>
    <div class="menuitem">
        <a href="/Management/ChangePassword"><?php echo $translated["change_password"] ?></a>
    </div>
    <?php if (RightHelper::loggedUserHasRight("VIEW_LOCATIONS") || RightHelper::loggedUserHasRight("VIEW_PROJECTS") || RightHelper::loggedUserHasRight("VIEW_REVIEWS") || RightHelper::loggedUserHasRight("VIEW_USERS")) {
        ?>
        <h2>Coordinator</h2>

        <?php if (RightHelper::loggedUserHasRight("VIEW_USERS")) { ?>
            <div class="menuitem" style="border-top:1px solid #d2dce1; margin-top:20px;">
                <a href="/Management/Users"><?php echo $translated["users"] ?></a>
            </div>
        <?php } ?>
        <?php if (RightHelper::loggedUserHasRight("VIEW_LOCATIONS")) { ?>
            <div class="menuitem">
                <a href="/Management/Locations"><?php echo $translated["locations"] ?></a>
            </div>
        <?php } ?>
        <?php if (RightHelper::loggedUserHasRight("VIEW_REVIEWS")) { ?>
            <div class="menuitem">
                <a href="/Management/Reviews"><?php echo $translated["reviews"] ?></a>
            </div>
        <?php } ?>
        <?php if (RightHelper::loggedUserHasRight("VIEW_PROJECTS")) { ?>
            <div class="menuitem">
                <a href="/Management/Projects"><?php echo $translated["projects"] ?></a>
            </div>
        <?php } ?>
        <?php if (RightHelper::loggedUserHasRight("UPLOAD_EXCEL")) { ?>
            <div class="menuitem">
                <a href="/Management/Upload"><?php echo $translated["upload_excelsheet"] ?></a>
            <?php } ?>
        </div>
    <?php } ?>
</div>

<?php
echo $content;


$footer = new \PROJ\Tools\Template("Partial/Footer");
echo $footer;
?>